<!DOCTYPE html>
<html>
  <head>
    <meta charset='UTF-8' />
    <meta property="og:description" content="Find LL shipping times by CEP input :D">
    <meta property="og:image" content="https://media.giphy.com/media/12NUbkX6p4xOO4/giphy.gif">
    <title>CEP Lookup</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  </head>
  <body>
    <div class="body">
      <div class="row">
        <div class="col-md-6 col-sm-12 left">
          <div class="input-group">
            <input id="zipcode" type="number" class="form-control" data-mask="00000000" maxlength="8" minlength="8" placeholder="CEP code here" name="zipcode"/>
            <div class="input-group-append">
              <input class="btn btn-primary" type="submit" onclick="getResults()">
            </div>
          </div>
        </div>
        <div class="col-md-6 col-sm-12 right">
          <div id="loaded"></div>
          <div id="results">
          </div>
        </div>
      </div>
    </div>

      <style type="text/css">

        .input-group{
          width: 50%;
        }

        .left{
          display : flex;
          justify-content : center;
          align-items : center;
          background-color:red;
          height : 100vh;
          color : #FFF;

        }
        .right{
          display : flex;
          justify-content : center;
          align-items : center;
          background-color:#FFF;
          height : 100vh;
          color : red;
        }

        @media screen and (max-width: 768px) {
          .left{
            height: 50vh;
          }
          .right{
            height: 50vh;
          }
        }

        #loading {
          border: 16px solid #f3f3f3;
          border-radius: 50%;
          border-top: 16px solid blue;
          border-right: 16px solid green;
          border-bottom: 16px solid red;
          width: 120px;
          height: 120px;
          -webkit-animation: spin 2s linear infinite;
          animation: spin 2s linear infinite;
        }

        @-webkit-keyframes spin {
          0% { -webkit-transform: rotate(0deg); }
          100% { -webkit-transform: rotate(360deg); }
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        /* Bootstrap 4 text input with search icon */

      </style>
      <script type="text/javascript">
        function getResults(){
          document.getElementById("results").innerHTML = "";
          document.getElementById("loaded").id = "loading";
          fetch("https://raw.githubusercontent.com/diegolearnstocode/cep_lookup/master/base.json")
              .then(function(response) {
                return response.json();
              })
              .then(function(myJson) {
                let cep = document.getElementById("zipcode").value;
                console.log(cep);
                let targetJson = myJson.filter(function (target) {
                return cep >= target.cep_from && cep <= target.cep_to && target.weight_from == "0,751"
                });
                document.getElementById("loading").id = "loaded";
                buildResults(targetJson[0]);
              });
            };

          function filterCep(myJson, cep){
            myJson.filter(function (target) {
              return cep >= target.cep_from && cep <= target.cep_to && target.weight_from == "0,751"
            });
          };

          function buildResults(targetCep) {
            let resultsDiv = document.getElementById('results');
            let time = targetCep.time + 2;
            let cost = targetCep.cost + 4;
            resultsDiv.innerHTML = "<h4>Estimated Shipping Time: " + time + " dias Ãºteis<br>Estimated Cost (smaill package): R$" + cost + "</h4>";
          };


      </script>
  </body>
</html>
